{"version":3,"sources":["webpack:///./src/pages/base-page/index.js","webpack:///./src/components/double-slider/index.js","webpack:///./src/pages/products/list/products-header.js","webpack:///./src/pages/products/list/index.js","webpack:///./src/constants/index.js","webpack:///./src/components/notification/index.js","webpack:///./src/utils/fetch-json.js","webpack:///./src/utils/escape-html.js","webpack:///./src/components/sortable-table/index.js"],"names":["BasePage","constructor","path","this","element","document","createElement","innerHTML","template","firstElementChild","subElements","getSubElements","components","getComponents","Object","keys","forEach","key","append","initEventListeners","parent","result","subElement","querySelectorAll","dataset","remove","destroy","values","component","DoubleSlider","min","max","formatValue","value","selected","from","to","event","target","classList","add","addEventListener","onPointerUp","onPointerMove","removeEventListener","dispatchEvent","CustomEvent","bubbles","detail","left","right","width","inner","getBoundingClientRect","x","clientX","thumbLeft","updateLeft","thumbRight","updateRight","render","getPercentLeft","getPercentRight","reset","onPointerDown","ratio","calculateSelectedFrom","textContent","progress","style","calculateSelectedTo","Math","round","header","id","title","sortable","data","length","url","sortType","escapeHtml","category","getTooltip","toLocaleString","LOCALE","Page","super","updateComponents","price_gte","price_lte","status","title_like","doubleSlider","sortableTable","SortableTable","PRODUCTS_REST_URL","rowUrl","row","emptyPlaceholder","searchParams","update","catch","error","Notification","message","type","NOTIFICATION_TYPE","show","onRangeSelect","filterStatus","onFilterStatus","filterName","onFilterName","querySelector","resetFilters","ORDERS_URL","SALES_URL","CUSTOMERS_URL","BESTSELLERS_URL","CATEGORIES_REST_URL","SUBCATEGORIES_REST_URL","ORDERS_REST_URL","BACKEND_URL","process","IMGUR_UPLOAD_URL","IMGUR_CLIENT_ID","success","duration","body","currentNotification","timeoutId","setTimeout","clearTimeout","params","response","fetch","toString","err","FetchError","ok","errorText","statusText","json","Error","window","reason","alert","string","replace","headerConfig","sortLocally","sorted","find","item","order","scrollable","isRunning","scrollY","innerHeight","documentElement","scrollHeight","start","end","pageSize","loadData","finally","column","closest","sort","asc","desc","URL","sortOnClient","updateSort","renderRows","sortData","sortOnServer","onWindowScroll","set","String","fetchJson","appendRows","setSearchParam","name","delete","entries","arrow","appendChild","toggleEmpty","getTableRows","push","rows","childNodes","map","getHeaderCell","join","getRowTemplate","getTableRow","sortedColumn","sortFunction","value1","value2","localeCompare","caseFirst","number","custom","direction"],"mappings":"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","file":"6.js","sourcesContent":["export default class BasePage {\n  element;\n  subElements = {};\n  components = {};\n\n  constructor(path) {\n\n  }\n\n  async render() {\n    this.element = document.createElement('div');\n    this.element.innerHTML = this.template;\n    this.element = this.element.firstElementChild;\n    this.subElements = this.getSubElements(this.element);\n\n    this.components = await this.getComponents();\n\n    Object.keys(this.components).forEach(key => {\n      this.subElements[key].append(this.components[key].element);\n    });\n\n    this.initEventListeners();\n\n    return this.element;\n  }\n\n  initEventListeners() {\n\n  }\n\n  get template() {\n    return `<div></div>`;\n  }\n\n  getSubElements(parent) {\n    const result = {};\n\n    for (const subElement of parent.querySelectorAll('[data-element]')) {\n      result[subElement.dataset.element] = subElement;\n    }\n    return result;\n  }\n\n  async getComponents() {\n    return {};\n  }\n\n  remove() {\n    if (this.element) {\n      this.element.remove();\n    }\n  }\n\n  destroy() {\n    this.remove();\n    this.element = null;\n    this.subElements = {};\n    Object.values(this.components).forEach(component => component.destroy());\n    this.components = {};\n  }\n}\n","export default class DoubleSlider {\n  element;\n  subElements = {};\n\n  onPointerDown = event => {\n    this.target = event.target;\n    this.element.classList.add('range-slider_dragging');\n\n    document.addEventListener('pointerup', this.onPointerUp);\n    this.element.addEventListener('pointermove', this.onPointerMove);\n  }\n\n  onPointerUp = () => {\n    this.element.removeEventListener('pointermove', this.onPointerMove);\n    document.removeEventListener('pointerup', this.onPointerUp);\n\n    this.element.classList.remove('range-slider_dragging');\n    this.target = null;\n\n    this.element.dispatchEvent(new CustomEvent('range-select', {\n      bubbles: true,\n      detail: {\n        from: this.selected.from,\n        to: this.selected.to\n      }\n    }));\n  }\n\n  onPointerMove = event => {\n    const {left, right, width} = this.subElements.inner.getBoundingClientRect();\n    const x = event.clientX;\n\n    if (this.target === this.subElements.thumbLeft) {\n      this.updateLeft(x < left ? 0 : (x - left) / width);\n    }\n\n    if (this.target === this.subElements.thumbRight) {\n      this.updateRight(x > right ? 0 : (right - x) / width);\n    }\n  }\n\n  constructor({\n                min = 0,\n                max = 100,\n                formatValue = value => value,\n                selected = {\n                  from: min,\n                  to: max\n                }\n              } = {}) {\n    this.min = min;\n    this.max = max;\n    this.formatValue = formatValue;\n    this.selected = selected;\n\n    this.render();\n    this.initEventListeners();\n  }\n\n  render() {\n    const left = this.getPercentLeft();\n    const right = this.getPercentRight();\n\n    this.element = document.createElement('div');\n    this.element.innerHTML = `\n      <div class=\"range-slider\">\n        <span data-element=\"from\">${this.formatValue(this.selected.from)}</span>\n        <div data-element=\"inner\" class=\"range-slider__inner\">\n          <span data-element=\"progress\" class=\"range-slider__progress\" style=\"left: ${left}; right: ${right}\"></span>\n          <span data-element=\"thumbLeft\" class=\"range-slider__thumb-left\" style=\"left: ${left}\"></span>\n          <span data-element=\"thumbRight\" class=\"range-slider__thumb-right\" style=\"right: ${right}\"></span>\n        </div>\n        <span data-element=\"to\">${this.formatValue(this.selected.to)}</span>\n      </div>\n    `;\n\n    this.element = this.element.firstElementChild;\n    this.subElements = this.getSubElements(this.element);\n  }\n\n  getSubElements(element) {\n    const result = {};\n\n    for (const subElement of element.querySelectorAll('[data-element]')) {\n      result[subElement.dataset.element] = subElement;\n    }\n    return result;\n  }\n\n  reset() {\n    this.updateLeft(0);\n    this.updateRight(0);\n  }\n\n  initEventListeners() {\n    this.subElements.thumbLeft.addEventListener('pointerdown', this.onPointerDown);\n    this.subElements.thumbRight.addEventListener('pointerdown', this.onPointerDown);\n  }\n\n  updateLeft(ratio) {\n    this.selected.from = this.calculateSelectedFrom(ratio);\n    this.subElements.from.textContent = this.formatValue(this.selected.from);\n\n    const left = this.getPercentLeft();\n    this.subElements.progress.style.left = left;\n    this.subElements.thumbLeft.style.left = left;\n  }\n\n  updateRight(ratio) {\n    this.selected.to = this.calculateSelectedTo(ratio);\n    this.subElements.to.textContent = this.formatValue(this.selected.to);\n\n    const right = this.getPercentRight();\n    this.subElements.progress.style.right = right;\n    this.subElements.thumbRight.style.right = right;\n  }\n\n  getPercentLeft() {\n    return 100 * (this.selected.from - this.min) / (this.max - this.min) + '%';\n  }\n\n  getPercentRight() {\n    return 100 * (this.max - this.selected.to) / (this.max - this.min) + '%';\n  }\n\n  calculateSelectedFrom(ratio) {\n    const from = this.min + (this.max - this.min) * ratio;\n    return Math.min(this.selected.to, Math.round(from));\n  }\n\n  calculateSelectedTo(ratio) {\n    const to = this.max - (this.max - this.min) * ratio;\n    return Math.max(this.selected.from, Math.round(to));\n  }\n\n  remove() {\n    if (this.element) {\n      this.element.remove();\n    }\n  }\n\n  destroy() {\n    this.remove();\n    this.element = null;\n    this.subElements = {};\n  }\n}\n","import escapeHtml from '../../../utils/escape-html';\nimport { LOCALE } from '../../../constants/index.js';\n\nconst header = [\n  {\n    id: 'images',\n    title: 'Фото',\n    sortable: false,\n    template: data => {\n      return `\n        <div class=\"sortable-table__cell\">\n          ${data.length ? `<img class=\"sortable-table-image\" alt=\"Image\" src=\"${data[0].url}\">` : ''}\n        </div>\n      `;\n    }\n  },\n  {\n    id: 'title',\n    title: 'Название',\n    sortable: true,\n    sortType: 'string'\n  },\n  {\n    id: 'subcategory',\n    title: 'Категория',\n    sortable: false,\n    template: data => {\n      return `\n        <div class=\"sortable-table__cell\">\n          <span data-tooltip=\"${escapeHtml(getTooltip(data))}\">${data.title}</span>\n        </div>\n      `;\n    }\n  },\n  {\n    id: 'quantity',\n    title: 'Количество',\n    sortable: true,\n    sortType: 'number'\n  },\n  {\n    id: 'price',\n    title: 'Цена',\n    sortable: true,\n    sortType: 'number',\n    template: data => {\n      return `\n        <div class=\"sortable-table__cell\">\n          $${data.toLocaleString(LOCALE)}\n        </div>\n      `;\n    }\n  },\n  {\n    id: 'status',\n    title: 'Статус',\n    sortable: true,\n    sortType: 'number',\n    template: data => {\n      return `\n        <div class=\"sortable-table__cell\">\n          ${data > 0 ? 'Активен' : 'Неактивен'}\n        </div>\n      `;\n    }\n  },\n];\n\nfunction getTooltip(data) {\n  return `\n    <div class=\"sortable-table-tooltip\">\n      <span class=\"sortable-table-tooltip__category\">${data.category.title}</span> /\n      <b class=\"sortable-table-tooltip__subcategory\">${data.title}</b>\n    </div>\n  `;\n}\n\nexport default header;\n","import BasePage from '../../base-page/index.js';\nimport DoubleSlider from '../../../components/double-slider/index.js';\nimport SortableTable from '../../../components/sortable-table/index.js';\nimport Notification from '../../../components/notification/index.js';\nimport { NOTIFICATION_TYPE, PRODUCTS_REST_URL } from '../../../constants/index.js';\nimport header from './products-header.js';\n\nconst URL_PATH = process.env.URL_PATH;\n\nexport default class Page extends BasePage {\n  onRangeSelect = event => {\n    const {from, to} = event.detail;\n    this.updateComponents({price_gte: from, price_lte: to});\n  }\n\n  onFilterStatus = event => {\n    this.updateComponents({status: event.target.value});\n  }\n\n  onFilterName = event => {\n    this.updateComponents({title_like: event.target.value});\n  }\n\n  constructor(path) {\n    super(path);\n  }\n\n  async getComponents() {\n    const doubleSlider = new DoubleSlider({\n      min: 0,\n      max: 5000,\n      formatValue: value => `$${value}`\n    });\n\n    const sortableTable = new SortableTable(header, {\n      url: `${PRODUCTS_REST_URL}?_embed=subcategory.category`,\n      rowUrl: row => `/${URL_PATH}products/${row.id}`\n    });\n\n    sortableTable.subElements.emptyPlaceholder.innerHTML = `\n      <div>\n        <p>Не найдено товаров, удовлетворяющих выбранным критериям</p>\n        <button type=\"button\" name=\"reset\" class=\"button-primary-outline\">Очистить фильтры</button>\n      </div>\n    `;\n\n    return {\n      doubleSlider,\n      sortableTable\n    };\n  }\n\n  async updateComponents(searchParams = {}) {\n    this.components.sortableTable.update(searchParams)\n      .catch(error => new Notification(error.message, {type: NOTIFICATION_TYPE.error}).show());\n  }\n\n  initEventListeners() {\n    this.element.addEventListener('range-select', this.onRangeSelect);\n    this.subElements.filterStatus.addEventListener('change', this.onFilterStatus);\n    this.subElements.filterName.addEventListener('input', this.onFilterName);\n    this.element.querySelector('button[name=\"reset\"]').addEventListener('click', () => this.resetFilters());\n  }\n\n  resetFilters() {\n    this.subElements.filterName.value = '';\n    this.subElements.filterStatus.value = '';\n\n    this.components.doubleSlider.reset();\n\n    const searchParams = {\n      price_gte: '',\n      price_lte: '',\n      title_like: '',\n      status: ''\n    };\n\n    this.updateComponents(searchParams);\n  }\n\n  get template() {\n    return `\n      <div class=\"products-list\">\n        <div class=\"content__top-panel\">\n          <h1 class=\"page-title\">Товары</h1>\n          <a href=\"/${URL_PATH}products/add\" class=\"button-primary\">Добавить товар</a>\n        </div>\n        <div class=\"content-box content-box_small\">\n          <form class=\"form-inline\">\n            <div class=\"form-group\">\n              <label class=\"form-label\">Сортировать по:</label>\n              <input type=\"text\" data-element=\"filterName\" class=\"form-control\" placeholder=\"Название товара\">\n            </div>\n            <div class=\"form-group\" data-element=\"sliderContainer\">\n              <label class=\"form-label\">Цена:</label>\n              <div data-element=\"doubleSlider\"></div>\n            </div>\n            <div class=\"form-group\">\n              <label class=\"form-label\">Статус:</label>\n              <select class=\"form-control\" data-element=\"filterStatus\">\n                <option value=\"\">Любой</option>\n                <option value=\"1\">Активный</option>\n                <option value=\"0\">Неактивный</option>\n              </select>\n            </div>\n          </form>\n        </div>\n        <div data-element=\"sortableTable\" class=\"products-list__container\"></div>\n      </div>\n    `;\n  }\n}\n","export const ORDERS_URL = 'api/dashboard/orders';\nexport const SALES_URL = 'api/dashboard/sales';\nexport const CUSTOMERS_URL = 'api/dashboard/customers';\nexport const BESTSELLERS_URL = 'api/dashboard/bestsellers';\n\nexport const PRODUCTS_REST_URL = 'api/rest/products';\nexport const CATEGORIES_REST_URL = 'api/rest/categories';\nexport const SUBCATEGORIES_REST_URL = 'api/rest/subcategories';\nexport const ORDERS_REST_URL = 'api/rest/orders';\n\nexport const BACKEND_URL = process.env.BACKEND_URL;\nexport const IMGUR_UPLOAD_URL = process.env.IMGUR_UPLOAD_URL;\nexport const IMGUR_CLIENT_ID = process.env.IMGUR_CLIENT_ID;\n\nexport const LOCALE = process.env.LOCALE;\n\nexport const NOTIFICATION_TYPE = {\n  success: 'success',\n  error: 'error'\n};\n","export default class Notification {\n\n  static currentNotification = null;\n\n  constructor(message = '', {duration = 2000, type = ''} = {}) {\n    this.message = message;\n    this.duration = duration;\n    this.type = type;\n    this.render();\n  }\n\n  render() {\n    this.element = document.createElement('div');\n    this.element.innerHTML = `\n      <div class=\"notification notification_${this.type} show\">\n        <div class=\"notification-body notification__content\">${this.message}</div>\n      </div>\n    `;\n    this.element = this.element.firstElementChild;\n  }\n\n  show(element = document.body) {\n    if (Notification.currentNotification) {\n      Notification.currentNotification.remove();\n    }\n\n    element.append(this.element);\n\n    this.timeoutId = setTimeout(() => {this.remove()}, this.duration)\n    Notification.currentNotification = this;\n  }\n\n  remove() {\n    if (this.element) {\n      this.element.remove();\n    }\n    clearTimeout(this.timeoutId);\n  }\n\n  destroy() {\n    this.remove();\n    this.element = null;\n    Notification.currentNotification = null;\n  }\n}\n","// same as fetch, but throws FetchError in case of errors\n// status >= 400 is an error\n// network error / json error are errors\n\nexport default async function(url, params) {\n  let response;\n\n  try {\n    // NOTE: \"toString\" call needed for correct work of \"jest-fetch-mock\"\n    response = await fetch(url.toString(), params);\n  } catch(err) {\n    throw new FetchError(response, \"Network error has occurred.\");\n  }\n\n  let body;\n\n  if (!response.ok) {\n    let errorText = response.statusText; // Not Found (for 404)\n\n    try {\n      body = await response.json();\n\n      errorText = (body.error && body.error.message) || (body.data && body.data.error && body.data.error.message) || errorText;\n    } catch (error) { /* ignore failed body */ }\n\n    let message = `Error ${response.status}: ${errorText}`;\n\n    throw new FetchError(response, body, message);\n  }\n\n  try {\n    return await response.json();\n  } catch(err) {\n    throw new FetchError(response, null, err.message);\n  }\n}\n\nexport class FetchError extends Error {\n  name = \"FetchError\";\n\n  constructor(response, body, message) {\n    super(message);\n    this.response = response;\n    this.body = body;\n  }\n}\n\n// handle uncaught failed fetch through\nwindow.addEventListener('unhandledrejection', event => {\n  if (event.reason instanceof FetchError) {\n    alert(event.reason.message);\n  }\n});\n\n","export default string => string\n  .replace(/&/g, '&amp;')\n  .replace(/\"/g, '&quot;')\n  .replace(/'/g, '&#39;')\n  .replace(/</g, '&lt;')\n  .replace(/>/g, '&gt;');\n","import Notification from '../notification/index.js';\nimport fetchJson from '../../utils/fetch-json.js';\nimport { NOTIFICATION_TYPE, BACKEND_URL } from '../../constants/index.js';\n\nexport default class SortableTable {\n  element;\n  subElements = {};\n  pageSize = 30;\n\n  onWindowScroll = () => {\n    if (this.isRunning) {\n      return;\n    }\n\n    const isScrolledToBottom = window.scrollY + window.innerHeight >= document.documentElement.scrollHeight;\n\n    if (isScrolledToBottom) {\n      this.isRunning = true;\n\n      const start = this.data.length;\n      const end = this.data.length + this.pageSize;\n\n      this.loadData(start, end, true)\n        .catch(error => new Notification(error.message, {type: NOTIFICATION_TYPE.error}).show())\n        .finally(() => this.isRunning = false);\n    }\n  }\n\n  onPointerDown = event => {\n    const column = event.target.closest('.sortable-table__cell[data-sortable]');\n\n    if (!column) {\n      return;\n    }\n\n    const toggle = {\n      asc: 'desc',\n      desc: 'asc'\n    };\n\n    this.sort(column.dataset.id, toggle[column.dataset.order]);\n  }\n\n  constructor(headerConfig = [], {\n    url = '',\n    sortLocally = false,\n    sorted = {\n      id: headerConfig.find(item => item.sortable).id,\n      order: 'asc'\n    },\n    scrollable = true,\n    rowUrl = null\n  } = {}) {\n    this.headerConfig = headerConfig;\n    this.rowUrl = rowUrl;\n    this.url = new URL(url, BACKEND_URL);\n    this.sortLocally = sortLocally;\n    this.sorted = sorted;\n    this.scrollable = scrollable;\n\n    this.render()\n      .catch(error => new Notification(error.message, {type: NOTIFICATION_TYPE.error}).show());\n  }\n\n  sortOnClient(id, order) {\n    this.updateSort(id, order);\n    this.renderRows(this.sortData(id, order));\n  }\n\n  sortOnServer(id, order) {\n    this.updateSort(id, order);\n    this.loadData()\n      .catch(error => new Notification(error.message, {type: NOTIFICATION_TYPE.error}).show());\n  }\n\n  initEventListeners() {\n    this.subElements.header.addEventListener('pointerdown', this.onPointerDown);\n    if (this.scrollable) {\n      window.addEventListener('scroll', this.onWindowScroll);\n    }\n  }\n\n  async render() {\n    this.element = document.createElement('div');\n    this.element.innerHTML = this.template;\n    this.element = this.element.firstElementChild;\n    this.subElements = this.getSubElements(this.element);\n\n    await this.loadData();\n\n    this.initEventListeners();\n  }\n\n  async loadData(start = 0, end = this.pageSize, append = false) {\n    this.url.searchParams.set('_sort', this.sorted.id);\n    this.url.searchParams.set('_order', this.sorted.order);\n    this.url.searchParams.set('_start', String(start));\n    this.url.searchParams.set('_end', String(end));\n\n    this.element.classList.add('sortable-table_loading');\n\n    const data = await fetchJson(this.url);\n\n    if (append) {\n      this.appendRows(data);\n    } else {\n      this.renderRows(data);\n    }\n\n    this.element.classList.remove('sortable-table_loading');\n  }\n\n  setSearchParam(name, value) {\n    if (value) {\n      this.url.searchParams.set(name, value);\n    } else {\n      this.url.searchParams.delete(name);\n    }\n  }\n\n  async update(searchParams = {}) {\n    Object.entries(searchParams).forEach(([name, value]) => this.setSearchParam(name, value));\n    await this.loadData();\n  }\n\n  updateSort(id, order) {\n    this.sorted = {id, order};\n\n    const {header, arrow} = this.subElements;\n\n    header.querySelectorAll('[data-sortable]')\n      .forEach(column => {\n        column.dataset.order = order;\n      });\n\n    header.querySelector(`[data-id=\"${id}\"]`).appendChild(arrow);\n  }\n\n  toggleEmpty() {\n    if (this.data.length) {\n      this.element.classList.remove('sortable-table_empty');\n    } else {\n      this.element.classList.add('sortable-table_empty');\n    }\n  }\n\n  renderRows(data) {\n    this.data = data;\n    this.subElements.body.innerHTML = this.getTableRows(data);\n    this.toggleEmpty();\n  }\n\n  appendRows(data) {\n    this.data.push(...data);\n\n    const rows = document.createElement('div');\n    rows.innerHTML = this.getTableRows(data);\n    this.subElements.body.append(...rows.childNodes);\n\n    this.toggleEmpty();\n  }\n\n  get template() {\n    return `\n      <div class=\"sortable-table\">\n        <div data-element=\"header\" class=\"sortable-table__header sortable-table__row\">\n          ${this.headerConfig.map(column => this.getHeaderCell(column)).join('')}\n        </div>\n        <div data-element=\"body\" class=\"sortable-table__body\"></div>\n        <div data-element=\"loading\" class=\"loading-line sortable-table__loading-line\"></div>\n        <div data-element=\"emptyPlaceholder\" class=\"sortable-table__empty-placeholder\">\n          <div>Нет данных</div>\n        </div>\n      </div>\n    `;\n  }\n\n  getHeaderCell({id, title, sortable}) {\n    const arrow =`\n      <span data-element=\"arrow\" class=\"sortable-table__sort-arrow\">\n        <span class=\"sort-arrow\"></span>\n      </span>\n    `;\n\n    return `\n      <div class=\"sortable-table__cell\" data-id=\"${id}\" ${sortable ? 'data-sortable=\"\"' : ''} data-order=\"${this.sorted.order}\">\n        <span>${title}</span>\n        ${id === this.sorted.id ? arrow : ''}\n      </div>\n    `;\n  }\n\n  getTableRows(data) {\n    return data.map(row => this.getRowTemplate(row)).join('');\n  }\n\n  getRowTemplate(row) {\n    if (this.rowUrl) {\n      return `\n        <a class=\"sortable-table__row\" href=\"${this.rowUrl(row)}\">\n          ${this.getTableRow(row)}\n        </a>\n      `;\n    } else {\n      return `\n        <div class=\"sortable-table__row\">\n          ${this.getTableRow(row)}\n        </div>\n      `;\n    }\n  }\n\n  getTableRow(data) {\n    return this.headerConfig\n      .map(({id, template}) => template ? template(data[id]) : `<div class='sortable-table__cell'>${data[id]}</div>`)\n      .join('');\n  }\n\n  getSubElements(parent) {\n    const result = {};\n\n    for (const subElement of parent.querySelectorAll('[data-element]')) {\n      result[subElement.dataset.element] = subElement;\n    }\n    return result;\n  }\n\n  remove() {\n    if (this.element) {\n      this.element.remove();\n    }\n  }\n\n  destroy() {\n    this.remove();\n    this.element = null;\n    this.subElements = {};\n    if (this.scrollable) {\n      window.removeEventListener('scroll', this.onWindowScroll);\n    }\n  }\n\n  sort(id, order) {\n    if (this.sortLocally) {\n      this.sortOnClient(id, order);\n    } else {\n      this.sortOnServer(id, order);\n    }\n  }\n\n  sortData(id, order) {\n    const sortedColumn = this.headerConfig.find(column => column.id === id);\n    const sortType = sortedColumn.sortType;\n\n    const sortFunction = {\n      string: (value1, value2) => value1.localeCompare(value2, ['ru', 'en'], {caseFirst: 'upper'}),\n      number: (value1, value2) => value1 - value2,\n      custom: sortedColumn.sortFunction\n    };\n\n    const direction = {\n      asc: 1,\n      desc: -1\n    };\n\n    return [...this.data].sort((value1, value2) =>\n      direction[order] * sortFunction[sortType](value1[id], value2[id])\n    );\n  }\n}\n"],"sourceRoot":""}