{"version":3,"sources":["webpack:///./src/pages/base-page/index.js","webpack:///./src/components/categories/index.js","webpack:///./src/pages/categories/index.js","webpack:///./src/constants/index.js","webpack:///./src/components/notification/index.js","webpack:///./src/utils/fetch-json.js","webpack:///./src/utils/escape-html.js","webpack:///./src/components/sortable-list/index.js"],"names":["BasePage","constructor","path","this","element","document","createElement","innerHTML","template","firstElementChild","subElements","getSubElements","components","getComponents","Object","keys","forEach","key","append","initEventListeners","parent","result","subElement","querySelectorAll","dataset","remove","destroy","values","component","Categories","url","URL","CATEGORIES_REST_URL","BACKEND_URL","render","catch","error","Notification","message","type","NOTIFICATION_TYPE","show","searchParams","set","fetchJson","data","loadCategories","renderCategories","map","category","Category","event","target","classList","contains","toggle","saveOrder","then","success","querySelector","createSubcategoriesList","addEventListener","onClick","onListOrderUpdate","id","escapeHtml","title","SortableList","items","subcategories","subcategory","createSubcategoriesListItem","count","order","index","weight","SUBCATEGORIES_REST_URL","method","headers","body","JSON","stringify","Page","super","categories","ORDERS_URL","SALES_URL","CUSTOMERS_URL","BESTSELLERS_URL","PRODUCTS_REST_URL","ORDERS_REST_URL","process","IMGUR_UPLOAD_URL","IMGUR_CLIENT_ID","LOCALE","duration","currentNotification","timeoutId","setTimeout","clearTimeout","params","response","fetch","toString","err","FetchError","ok","errorText","statusText","json","status","Error","window","reason","alert","string","replace","item","closest","preventDefault","startDragging","clientX","clientY","x","shiftX","y","shiftY","moveAt","placeholder","top","bottom","getBoundingClientRect","offsetHeight","previousElementSibling","before","nextElementSibling","after","stopDragging","add","onPointerDown","style","left","indexFrom","getIndex","rect","width","height","createPlaceholder","parentElement","onPointerMove","onPointerUp","cssText","removeEventListener","indexTo","dispatchEvent","CustomEvent","bubbles","detail","i","current"],"mappings":"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","file":"categories-index-js-2.js","sourcesContent":["export default class BasePage {\n  element;\n  subElements = {};\n  components = {};\n\n  constructor(path) {\n\n  }\n\n  async render() {\n    this.element = document.createElement('div');\n    this.element.innerHTML = this.template;\n    this.element = this.element.firstElementChild;\n    this.subElements = this.getSubElements(this.element);\n\n    this.components = await this.getComponents();\n\n    Object.keys(this.components).forEach(key => {\n      this.subElements[key].append(this.components[key].element);\n    });\n\n    this.initEventListeners();\n\n    return this.element;\n  }\n\n  initEventListeners() {\n\n  }\n\n  get template() {\n    return `<div></div>`;\n  }\n\n  getSubElements(parent) {\n    const result = {};\n\n    for (const subElement of parent.querySelectorAll('[data-element]')) {\n      result[subElement.dataset.element] = subElement;\n    }\n    return result;\n  }\n\n  async getComponents() {\n    return {};\n  }\n\n  remove() {\n    if (this.element) {\n      this.element.remove();\n    }\n  }\n\n  destroy() {\n    this.remove();\n    this.element = null;\n    this.subElements = {};\n    Object.values(this.components).forEach(component => component.destroy());\n    this.components = {};\n  }\n}\n","import SortableList from '../sortable-list/index.js';\nimport Notification from '../notification/index.js';\nimport escapeHtml from '../../utils/escape-html.js';\nimport fetchJson from '../../utils/fetch-json.js';\n\nimport { NOTIFICATION_TYPE, CATEGORIES_REST_URL, SUBCATEGORIES_REST_URL, BACKEND_URL } from '../../constants/index.js';\n\nexport default class Categories {\n  element;\n\n  constructor() {\n    this.url = new URL(CATEGORIES_REST_URL, BACKEND_URL);\n    this.render()\n      .catch(error => new Notification(error.message, {type: NOTIFICATION_TYPE.error}).show());\n  }\n\n  async loadCategories() {\n    this.url.searchParams.set('_sort', 'weight');\n    this.url.searchParams.set('_refs', 'subcategory');\n    return await fetchJson(this.url);\n  }\n\n  async render() {\n    this.element = document.createElement('div');\n    this.element.dataset.element = 'categories';\n\n    this.data = await this.loadCategories();\n\n    this.element.append(...this.renderCategories());\n  }\n\n  renderCategories() {\n    return this.data.map(category => new Category(category).element);\n  }\n\n  remove() {\n    if (this.element) {\n      this.element.remove();\n    }\n  }\n\n  destroy() {\n    this.remove();\n    this.element = null;\n  }\n}\n\nclass Category {\n  element;\n\n  onClick = event => {\n    if (event.target.classList.contains('category__header')) {\n      this.toggle();\n    }\n  }\n\n  onListOrderUpdate = () => {\n    this.saveOrder()\n      .then(() => new Notification('Изменения сохранены!', {type: NOTIFICATION_TYPE.success}).show())\n      .catch(error => new Notification(error.message, {type: NOTIFICATION_TYPE.error}).show());\n  }\n\n  constructor(data) {\n    this.data = data;\n    this.render();\n  }\n\n  render() {\n    this.element = document.createElement('div');\n    this.element.innerHTML = this.template;\n    this.element = this.element.firstElementChild;\n\n    this.element.querySelector('.subcategory-list').append(this.createSubcategoriesList());\n\n    this.initEventListeners();\n  }\n\n  initEventListeners() {\n    this.element.addEventListener('click', this.onClick);\n    this.element.addEventListener('list-order-update', this.onListOrderUpdate);\n  }\n\n  get template() {\n    return `\n      <div class=\"category category_open\" data-id=\"${this.data.id}\">\n        <header class=\"category__header\">\n          ${escapeHtml(this.data.title)}\n        </header>\n        <div class=\"category__body\">\n          <div class=\"subcategory-list\"></div>\n        </div>\n      </div>\n    `;\n  }\n\n  toggle() {\n    this.element.classList.toggle('category_open');\n  }\n\n  createSubcategoriesList() {\n    const sortableList = new SortableList({\n      items: this.data.subcategories.map(subcategory => this.createSubcategoriesListItem(subcategory))\n    });\n\n    return sortableList.element;\n  }\n\n  createSubcategoriesListItem({id, title, count}) {\n    const element = document.createElement('div');\n\n    element.innerHTML = `\n      <li class='categories__sortable-list-item sortable-list__item' data-grab-handle='' data-id='${id}'>\n        <strong>${escapeHtml(title)}</strong>\n        <span><b>${count}</b> товаров</span>\n      </li>\n    `;\n    return element.firstElementChild;\n  }\n\n  async saveOrder() {\n    const order = [...this.element.querySelectorAll('.sortable-list__item')]\n      .map((element, index) => {\n        return {\n          id: element.dataset.id,\n          weight: index + 1\n        };\n      });\n\n    this.data.subcategories = await fetchJson(new URL(SUBCATEGORIES_REST_URL, BACKEND_URL), {\n      method: 'PATCH',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(order)\n    });\n  }\n\n  remove() {\n    if (this.element) {\n      this.element.remove();\n    }\n  }\n\n  destroy() {\n    this.remove();\n    this.element = null;\n  }\n}\n","import BasePage from '../base-page/index.js';\nimport Categories from '../../components/categories/index.js';\n\nexport default class Page extends BasePage {\n  constructor(path) {\n    super(path);\n  }\n\n  get template() {\n    return `\n      <div class=\"categories\">\n        <div class=\"content__top-panel\">\n          <h1 class=\"page-title\">Категории товаров</h1>\n        </div>\n        <div data-element=\"categories\"></div>\n      </div>\n    `;\n  }\n\n  async getComponents() {\n    const categories = new Categories();\n\n    return {\n      categories\n    };\n  }\n}\n","export const ORDERS_URL = 'api/dashboard/orders';\nexport const SALES_URL = 'api/dashboard/sales';\nexport const CUSTOMERS_URL = 'api/dashboard/customers';\nexport const BESTSELLERS_URL = 'api/dashboard/bestsellers';\n\nexport const PRODUCTS_REST_URL = 'api/rest/products';\nexport const CATEGORIES_REST_URL = 'api/rest/categories';\nexport const SUBCATEGORIES_REST_URL = 'api/rest/subcategories';\nexport const ORDERS_REST_URL = 'api/rest/orders';\n\nexport const BACKEND_URL = process.env.BACKEND_URL;\nexport const IMGUR_UPLOAD_URL = process.env.IMGUR_UPLOAD_URL;\nexport const IMGUR_CLIENT_ID = process.env.IMGUR_CLIENT_ID;\n\nexport const LOCALE = process.env.LOCALE;\n\nexport const NOTIFICATION_TYPE = {\n  success: 'success',\n  error: 'error'\n};\n","export default class Notification {\n\n  static currentNotification = null;\n\n  constructor(message = '', {duration = 2000, type = ''} = {}) {\n    this.message = message;\n    this.duration = duration;\n    this.type = type;\n    this.render();\n  }\n\n  render() {\n    this.element = document.createElement('div');\n    this.element.innerHTML = `\n      <div class=\"notification notification_${this.type} show\">\n        <div class=\"notification-body notification__content\">${this.message}</div>\n      </div>\n    `;\n    this.element = this.element.firstElementChild;\n  }\n\n  show(element = document.body) {\n    if (Notification.currentNotification) {\n      Notification.currentNotification.remove();\n    }\n\n    element.append(this.element);\n\n    this.timeoutId = setTimeout(() => {this.remove()}, this.duration)\n    Notification.currentNotification = this;\n  }\n\n  remove() {\n    if (this.element) {\n      this.element.remove();\n    }\n    clearTimeout(this.timeoutId);\n  }\n\n  destroy() {\n    this.remove();\n    this.element = null;\n    Notification.currentNotification = null;\n  }\n}\n","// same as fetch, but throws FetchError in case of errors\n// status >= 400 is an error\n// network error / json error are errors\n\nexport default async function(url, params) {\n  let response;\n\n  try {\n    // NOTE: \"toString\" call needed for correct work of \"jest-fetch-mock\"\n    response = await fetch(url.toString(), params);\n  } catch(err) {\n    throw new FetchError(response, \"Network error has occurred.\");\n  }\n\n  let body;\n\n  if (!response.ok) {\n    let errorText = response.statusText; // Not Found (for 404)\n\n    try {\n      body = await response.json();\n\n      errorText = (body.error && body.error.message) || (body.data && body.data.error && body.data.error.message) || errorText;\n    } catch (error) { /* ignore failed body */ }\n\n    let message = `Error ${response.status}: ${errorText}`;\n\n    throw new FetchError(response, body, message);\n  }\n\n  try {\n    return await response.json();\n  } catch(err) {\n    throw new FetchError(response, null, err.message);\n  }\n}\n\nexport class FetchError extends Error {\n  name = \"FetchError\";\n\n  constructor(response, body, message) {\n    super(message);\n    this.response = response;\n    this.body = body;\n  }\n}\n\n// handle uncaught failed fetch through\nwindow.addEventListener('unhandledrejection', event => {\n  if (event.reason instanceof FetchError) {\n    alert(event.reason.message);\n  }\n});\n\n","export default string => string\n  .replace(/&/g, '&amp;')\n  .replace(/\"/g, '&quot;')\n  .replace(/'/g, '&#39;')\n  .replace(/</g, '&lt;')\n  .replace(/>/g, '&gt;');\n","export default class SortableList {\n  element;\n\n  onPointerDown = event => {\n    const item = event.target.closest('.sortable-list__item');\n\n    if (item) {\n      if (event.target.closest('[data-grab-handle]')) {\n        event.preventDefault();\n        this.startDragging(event.clientX, event.clientY, item);\n      }\n\n      if (event.target.closest('[data-delete-handle]')) {\n        event.preventDefault();\n        item.remove();\n      }\n    }\n  }\n\n  onPointerMove = event => {\n    const item = this.element.querySelector('.sortable-list__item.sortable-list__item_dragging');\n    if (!item) {\n      return;\n    }\n\n    event.preventDefault();\n\n    const x = event.clientX - this.shiftX;\n    const y = event.clientY - this.shiftY;\n    this.moveAt(x, y, item);\n\n    const placeholder = this.element.querySelector('.sortable-list__placeholder');\n    const {top, bottom} = placeholder.getBoundingClientRect();\n    const {offsetHeight} = placeholder;\n\n    if (placeholder.previousElementSibling) {\n      if (bottom - offsetHeight / 2 > item.getBoundingClientRect().bottom) {\n        placeholder.previousElementSibling.before(placeholder);\n      }\n    }\n\n    if (placeholder.nextElementSibling) {\n      if (top + offsetHeight / 2 < item.getBoundingClientRect().top) {\n        placeholder.nextElementSibling.after(placeholder);\n      }\n    }\n  }\n\n  onPointerUp = event => {\n    const item = this.element.querySelector('.sortable-list__item.sortable-list__item_dragging');\n    if (!item) {\n      return;\n    }\n\n    this.stopDragging(item);\n  }\n\n  constructor({items = []}) {\n    this.items = items;\n\n    this.render();\n    this.initEventListeners();\n  }\n\n  render() {\n    this.element = document.createElement('ul');\n    this.element.classList.add('sortable-list');\n\n    this.items.forEach(item => {\n      item.classList.add('sortable-list__item');\n    });\n\n    this.element.append(...this.items);\n  }\n\n  initEventListeners() {\n    this.element.addEventListener('pointerdown', this.onPointerDown);\n    this.element.addEventListener('dragstart', () => false);\n  }\n\n  moveAt(x, y, element) {\n    element.style.left = `${x}px`;\n    element.style.top = `${y}px`;\n  }\n\n  startDragging(x, y, element) {\n    this.indexFrom = this.getIndex(element);\n\n    const rect = element.getBoundingClientRect();\n\n    this.shiftX = x - rect.left;\n    this.shiftY = y - rect.top;\n\n    element.classList.add('sortable-list__item_dragging');\n    element.style.width = `${rect.width}px`;\n    element.style.height = `${rect.height}px`;\n    element.style.left = `${rect.left}px`;\n    element.style.top = `${rect.top}px`;\n\n    element.after(this.createPlaceholder(rect.width, rect.height));\n\n    // move to the bottom of the list\n    element.parentElement.append(element);\n\n    document.addEventListener('pointermove', this.onPointerMove);\n    document.addEventListener('pointerup', this.onPointerUp);\n  }\n\n  stopDragging(element) {\n    element.classList.remove('sortable-list__item_dragging');\n    element.style.cssText = '';\n\n    const placeholder = this.element.querySelector('.sortable-list__placeholder');\n    placeholder.before(element);\n    placeholder.remove();\n\n    document.removeEventListener('pointermove', this.onPointerMove);\n    document.removeEventListener('pointerdown', this.onPointerDown);\n\n    const indexTo = this.getIndex(element);\n\n    if (this.indexFrom !== indexTo) {\n      this.element.dispatchEvent(new CustomEvent('list-order-update', {\n        bubbles: true,\n        detail: {\n          indexFrom: this.indexFrom,\n          indexTo: indexTo\n        }\n      }));\n    }\n  }\n\n  createPlaceholder(width, height) {\n    const placeholder = document.createElement('div');\n\n    placeholder.classList.add('sortable-list__placeholder');\n    placeholder.style.width = `${width}px`;\n    placeholder.style.height = `${height}px`;\n\n    return placeholder;\n  }\n\n  getIndex(element) {\n    let i = 0;\n    let current = element;\n    while (current.previousElementSibling) {\n      current = current.previousElementSibling;\n      i++;\n    }\n    return i;\n  }\n\n  remove() {\n    if (this.element) {\n      this.element.remove();\n    }\n  }\n\n  destroy() {\n    this.remove();\n    this.element = null;\n  }\n}\n"],"sourceRoot":""}